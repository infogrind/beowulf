<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:security="http://www.springframework.org/schema/security"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">

	<bean id="someBean" class="ch.hotstuff.beowulf.wsclient.util.impl.SomeBeanImpl">
		<property name="name" value="Katzeklo" />
	</bean>

	<!-- <bean id="webService_proxyFactory" class="org.apache.cxf.jaxws.JaxWsProxyFactoryBean"> 
		<property name="serviceClass" value="ch.hotstuff.beowulf.services.HelloWorld" 
		/> <property name="address" value="http://localhost:8443/webservice/HelloWorld" 
		/> </bean> -->

	<!-- This bean is here just for illustration purposes. Instead, we use
		an instance of JaxWsPortProxyFactoryWrapper, because it is not possible to instantiate
		a single port firectly from this bean via the CommonsPoolTargetSource. -->
	<bean id="helloService_portProxy"
		class="org.springframework.remoting.jaxws.JaxWsPortProxyFactoryBean" scope="prototype">
		<property name="serviceInterface" value="ch.hotstuff.beowulf.services.HelloWorld" />
		<property name="serviceName" value="HelloWorld" />
		<property name="endpointAddress" value="http://localhost:8443/webservice/HelloWorld" />
	</bean>
	
	<!-- This bean simply wraps the JaxWsPortProxyFactoryBean but adds a factory method to get a
		single port. It is not possible to get a port directly via CommonsPoolTargetSource. -->
	<bean id="helloService_portWrapper" class="ch.hotstuff.beowulf.wsclient.spring.JaxWsPortProxyFactoryWrapper">
		<property name="serviceInterface" value="ch.hotstuff.beowulf.services.HelloWorld" />
		<property name="serviceName" value="HelloWorld" />
		<property name="endpointAddress" value="http://localhost:8443/webservice/HelloWorld" />
	</bean>

	<bean id="helloService_wrappedPortProxy" scope="prototype" 
		factory-bean="helloService_portWrapper" factory-method="getPortInstance" />

	<bean id="helloService_portPool" class="org.springframework.aop.target.CommonsPoolTargetSource">
		<!-- <property name="targetBeanName" value="helloService_portProxy" /> -->
		<property name="targetBeanName" value="helloService_wrappedPortProxy" />
		<property name="maxSize" value="-1" />
		<property name="maxIdle" value="-1" />
	</bean>
	
	<bean id="helloService" class="org.springframework.aop.framework.ProxyFactoryBean">
		<property name="targetSource" ref="helloService_portPool" />
	</bean>
	
</beans>
